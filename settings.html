<div id="autopulse_settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>ST-AutoPulse</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">

            <!-- Connection Status -->
            <div id="autopulse_connection_status" class="autopulse-status">
                <span class="autopulse-status-dot" id="autopulse_status_dot"></span>
                <span id="autopulse_status_text">未连接到服务端</span>
            </div>

            <hr />

            <!-- Main Toggle -->
            <div class="autopulse-row">
                <label class="checkbox_label" for="autopulse_enabled">
                    <input type="checkbox" id="autopulse_enabled" />
                    <span data-i18n="启用自动消息">启用自动消息</span>
                </label>
            </div>

            <!-- Interval Setting -->
            <div class="autopulse-row">
                <label for="autopulse_interval">
                    <span data-i18n="消息间隔（分钟）">消息间隔（分钟）</span>
                </label>
                <div class="autopulse-interval-control">
                    <input type="range" id="autopulse_interval_range" min="1" max="180" value="30" />
                    <input type="number" id="autopulse_interval_input" min="1" max="180" value="30" class="text_pole autopulse-number-input" />
                </div>
            </div>

            <!-- Timer Status -->
            <div class="autopulse-row" id="autopulse_timer_info" style="display:none;">
                <small>
                    <span class="fa-solid fa-clock"></span>
                    <span id="autopulse_next_trigger">下次触发：计算中...</span>
                </small>
            </div>

            <hr />

            <!-- Custom Prompt -->
            <div class="autopulse-row">
                <label for="autopulse_prompt">
                    <span data-i18n="自定义触发提示词">自定义触发提示词</span>
                    <small class="autopulse-hint">（留空使用默认提示词）</small>
                </label>
                <textarea id="autopulse_prompt" class="text_pole autopulse-textarea" rows="3"
                    placeholder="例如：一段时间过去了，角色想要主动联系用户。根据当前对话上下文和角色性格，生成一条自然的主动消息。"></textarea>
            </div>

            <hr />

            <!-- Desktop Notifications -->
            <div class="autopulse-row">
                <label class="checkbox_label" for="autopulse_notify">
                    <input type="checkbox" id="autopulse_notify" />
                    <span data-i18n="桌面通知">桌面通知</span>
                </label>
            </div>

            <!-- Trigger Now Button -->
            <div class="autopulse-row">
                <div id="autopulse_trigger_now" class="menu_button menu_button_icon">
                    <span class="fa-solid fa-bolt"></span>
                    <span data-i18n="立即触发一次">立即触发一次</span>
                </div>
            </div>

            <hr />

            <!-- Scheduled Tasks Section -->
            <div class="autopulse-section-header">
                <b data-i18n="定时任务">定时任务</b>
            </div>

            <div id="autopulse_tasks_list" class="autopulse-tasks-list">
                <!-- Tasks will be dynamically populated -->
                <div class="autopulse-empty-state" id="autopulse_no_tasks">
                    <span class="fa-regular fa-calendar-xmark"></span>
                    <span data-i18n="暂无定时任务">暂无定时任务</span>
                </div>
            </div>

            <!-- Add Task Form -->
            <div class="autopulse-add-task">
                <div class="autopulse-row">
                    <input type="text" id="autopulse_task_name" class="text_pole" placeholder="任务名称（如：早安问候）" />
                </div>
                <div class="autopulse-row autopulse-task-time-row">
                    <input type="time" id="autopulse_task_time" class="text_pole" value="09:00" />
                    <select id="autopulse_task_repeat" class="text_pole">
                        <option value="daily">每天</option>
                        <option value="weekly">每周</option>
                        <option value="once">一次性</option>
                    </select>
                </div>
                <div class="autopulse-row" id="autopulse_weekday_row" style="display:none;">
                    <select id="autopulse_task_weekday" class="text_pole">
                        <option value="1">周一</option>
                        <option value="2">周二</option>
                        <option value="3">周三</option>
                        <option value="4">周四</option>
                        <option value="5">周五</option>
                        <option value="6">周六</option>
                        <option value="0">周日</option>
                    </select>
                </div>
                <div class="autopulse-row" id="autopulse_date_row" style="display:none;">
                    <input type="date" id="autopulse_task_date" class="text_pole" />
                </div>
                <div class="autopulse-row">
                    <textarea id="autopulse_task_prompt" class="text_pole autopulse-textarea" rows="2"
                        placeholder="任务提示词（留空使用默认）"></textarea>
                </div>
                <div class="autopulse-row">
                    <div id="autopulse_add_task_btn" class="menu_button menu_button_icon">
                        <span class="fa-solid fa-plus"></span>
                        <span data-i18n="添加任务">添加任务</span>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
